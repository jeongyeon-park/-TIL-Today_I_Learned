# 10. Observable


### ì €ë²ˆ ì‹œê°„ì—ëŠ” ~
íŠ¹ì • ë°ì´í„°ë¥¼ ëª¨ë“ˆì—ì„œ ì œê³µ (provider) í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°›ëŠ” (Inject) ë‚´ìš©ì„ ì‚´í´ë³´ì•˜ë‹¤

ëª¨ë“ˆì—ì„œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ê³  ê³µìœ í•˜ëŠ” ë°©ë²•ì€ ê°ê°ì˜ ì»´í¬ë„ŒíŠ¸ì—ê²Œ ì¼ê´„ëœ ë‚´ìš©ì„ ì „ë‹¬í•˜ê¸° ìœ„í•´ ìì£¼ ì‚¬ìš©ëœë‹¤. 

ë˜í•œ ì‚¬ìš©í•˜ëŠ” ë‹¤ë¥¸ ëª¨ë“ˆì—ê²Œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•ìœ¼ë¡œë„ ì‚¬ìš©ëœë‹¤.

## ğŸµ Service ìƒì„±í•˜ì—¬ ë°ì´í„° ì „ë‹¬í•˜ê¸° 

### 1. ng g service my-service ë¡œ ì„œë¹„ìŠ¤ ìƒì„±í•˜ê¸° 
```typescript
import { Injectable } from '@angular/core';
import { INFORMATION } from './MyType';

@Injectable({
  providedIn: 'root'
})
export class MyServiceService {

  public readonly myData : INFORMATION = { // ë‚´ê°€ ì „ë‹¬ í•  ë°ì´í„°
    data1:'data1',
    data2: 1433,
    data3: ['data3_1', 'data3_2']
  };
  
  constructor() { }
}
```
- ì „ë‹¬í•  ë°ì´í„° ì…ë ¥í•˜ê¸° 

### 2. ëª¨ë“ˆì˜ providerp ì— MyServiceService ë“±ë¡í•˜ê¸° 
```typescript
import { MyServiceService } from './my-service.service';


@NgModule({
  declarations: [
    AppComponent,
    LoginComponent,
    DashboardComponent
  ],
  imports: [                                  // importsë¥¼ í†µí•´ì„œ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë“¤ì´ í•´ë‹¹ ëª¨ë“ˆì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ ì¤€ë‹¤.  
    BrowserModule,
    FormsModule,
    ReactiveFormsModule // ë°˜ì‘í˜• í¼ ì‚¬ìš© 
  ],
  providers: [
    MyServiceService 
  ], 
  bootstrap: [AppComponent]
})
export class AppModule { }
```

3. component ì˜ constructor ì— serviceë¡œ ë°›ê¸° 
```typescript
export class LoginComponent implements OnInit {
  @Input() visible1 : boolean = false; // ë°›ëŠ” ì—­í• 
  @Output() sendMyEvent : EventEmitter<any> = new EventEmitter(); //ë³´ë‚´ëŠ” ì—­í• 
  id = new FormControl(); // í¼ ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ë¡œ ë°”ê¾¼ë‹¤.
  pwd = new FormControl('',[Validators.required, Validators.minLength(4)]); // í¼ ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ë¡œ ë°”ê¾¼ë‹¤. 
  
  private message :any;
  constructor(service : MyServiceService) { 
    console.log(service);
  }
```

ì„œë¹„ìŠ¤ì—ëŠ” 2ê°€ì§€ í˜•íƒœì˜ í´ë˜ìŠ¤ê°€ ì¡´ì¬ í•œë‹¤. 
1ê°œëŠ” BehaviorSubject , ë‹¤ë¥¸ 1ê°œëŠ” Observable ì´ë‹¤. 

BehaviorSubject í´ë˜ìŠ¤ëŠ” ë°ì´í„°ì˜ ë³€í™”ì— ëŒ€í•´ì„œ ë§ˆì¹˜ ê³µì¥ì²˜ëŸ¼ ë°œí–‰ì„ í•˜ëŠ” í´ë˜ìŠ¤ 

BehaviorSubjectëŠ” next ë¼ëŠ” í•¨ìˆ˜ë¥¼ í†µí•´ì„œ ë°ì´í„°ë¥¼ ì „ë‹¬í•œë‹¤. 

Observable í´ë˜ìŠ¤ëŠ” ê·¸ëŸ¬í•œ BehaviorSubject í´ë˜ìŠ¤ë¥¼ ë°”ë¼ë³´ëŠ” êµ¬ë…ìë‹¤.

BehaviorSubject ì˜ í´ë˜ìŠ¤ê°€ nextë¡œ í–‰ìœ„ë¥¼ ì „ë‹¬í•˜ë©´ êµ¬ë…í•˜ëŠ” Observable í´ë˜ìŠ¤ê°€ ê·¸ í–‰ë™ì— ëŒ€í•œ í–‰ìœ„ë¥¼ ì‹¤ì‹œí•œë‹¤. 

ë¹„ìœ í•˜ìë©´ BehaviorSubject í´ë˜ìŠ¤ëŠ” ì±„íŒ…ì•±ì´ë‹¤. 
Observable í´ë˜ìŠ¤ëŠ” ì±„íŒ…ì•±ì„ ì‚¬ìš©í•˜ëŠ” ì‚¬ìš©ìë‹¤

BehaviorSubject ì˜ next í•¨ìˆ˜ì˜ ê¸°ëŠ¥ì€ ì±„íŒ…ì•±ì—ì„œ ì±„íŒ… ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ëŠ” ê²½ìš°ë‹¤
ê·¸ë¦¬ê³  Observable í´ë˜ìŠ¤ì˜ subscribe ê¸°ëŠ¥ì€ ì±„íŒ…ì•±ì—ì„œ ì•Œë¦¼ì´ ì˜¨ ê²½ìš°ë‹¤. 

~ my-service.service 
```typescript
import { Injectable } from '@angular/core';
import { BehaviorSubject, Observable } from 'rxjs';
import { INFORMATION } from './MyType';

@Injectable({
  providedIn: 'root'
})
export class MyServiceService {

  public readonly myData : INFORMATION = { // ë‚´ê°€ ì „ë‹¬ í•  ë°ì´í„°
    data1:'data1',
    data2: 1433,
    data3: ['data3_1', 'data3_2']
  };

  constructor() { }

  private FACTORY : BehaviorSubject<any> = new BehaviorSubject({});
  public  TV: Observable<any> = this.FACTORY.asObservable();

  public addData(arg: boolean, loginInfomation? : any) : void{
    if(arg){
      this.FACTORY.next(loginInfomation);
    }
  } 
}
```


- service ì—ì„œ BehaviorSubject(ì±„íŒ… ì•±) Observable(ì‚¬ìš©ì) ì„ ì–¸
- addData ê°€ í˜¸ì¶œ ë˜ë©´ BehaviorSubject ì—ì„œ nextë¡œ í–‰ìœ„ë¥¼ ì „ë‹¬í•˜ë©´ êµ¬ë…í•˜ëŠ” Observable í´ë˜ìŠ¤ê°€ ê·¸ í–‰ë™ì— ëŒ€í•œ í–‰ìœ„ë¥¼ ì‹¤ì‹œí•œë‹¤. 

~ app.component.ts
```typescript
import { Component } from '@angular/core';
import { SelectControlValueAccessor } from '@angular/forms';
import { MyServiceService } from './my-service.service';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent {
  loginBool = true;
  boardBool = false;


  constructor(private service : MyServiceService){
    service.TV.subscribe( arg =>{
      console.log('ì„œë¹„ìŠ¤ì˜ íŠ¹ì • ë°ì´í„°ê°€ ë³€ë™ë˜ì–´ ë™ì‘í–ˆìŠµë‹ˆë‹¤ :' , arg);
    });
  }
  getEventThanks(event:any){
    console.log(event);
    if(event == true){
      this.loginBool = false;
      // this.boardBool = true;
    }
  }
}
```

~ login.component.ts
```typescript
  constructor(private service : MyServiceService) { // private ì œì–´ìë¥¼ ë¶™ì—¬ì„œ í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ ì‚¬ìš©ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.
    console.log(service);
  }

  ngOnInit(): void {
  }

  tryToLogin() : void{
    console.log(this.pwd);
    this.service.addData(true, {id:'admin', name:'ì‚¬ìš©ì'}); // ì„œë¹„ìŠ¤ì˜ addData í•¨ìˆ˜ í˜¸ì¶œ
```
- login ë²„íŠ¼ì„ ì„ íƒí•˜ë©´ service ì— addData ë¡œ {id:'admin', name: ì‚¬ìš©ì } ì „ë‹¬ 

### login ì»´í¬ë„ŒíŠ¸ 
1. login ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ì„œë¹„ìŠ¤ì˜ addData í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤. 
2. addDataí•¨ìˆ˜ëŠ” BehaviorSubject í´ë˜ìŠ¤ì˜ next í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ê¸°ëŠ¥ 
3. ë‹¤ì‹œ ë§í•´ login ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ì±„íŒ… ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê³  ìˆë‹¤.
4. app ì»´í¬ë„ŒíŠ¸ë¥¼ ë³´ì
5. app ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ìƒì„±ìë¥¼ í†µí•´ ì„œë¹„ìŠ¤ë¥¼ ë°›ì€ ë‹¤ìŒ subscribe í•˜ê³  ìˆë‹¤. 
6. ì±„íŒ… ë©”ì„¸ì§€ê°€ ë‚ ì•„ì˜¤ë©´ ë©”ì‹œì§€ê°€ ë„ì°©í•˜ë©´ ê·¸ ë‹¤ìŒ í–‰ë™ì— ëŒ€í•´ì„œ ì •ì˜ í•˜ê³  ìˆë‹¤. 


ì„œë¹„ìŠ¤ëŠ” ëª¨ë“ˆì—ì„œ ì œê³µ(provider) ë˜ì–´ì•¼í•˜ë©° ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ìƒì„±ì(constructor)ë¥¼ í†µí•´ ê³µê¸‰ ë°›ëŠ”ë‹¤. 

ë°ì´í„° ë³€ê²½ì— ë”°ë¥¸ ì´ë²¤íŠ¸ë¥¼ ì†ì‰½ê²Œ êµ¬í˜„í•˜ë ¤ë©´ behaviorSubject í´ë˜ìŠ¤ì™€ Observable í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œë‹¤. 
BehaviorSubject í´ë˜ìŠ¤ëŠ” ì´ë²¤íŠ¸ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ”, ì±„íŒ…ì•±ê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ë©°, next í•¨ìˆ˜ë¥¼ í†µí•´ ì´ë²¤íŠ¸ë¥¼ ë°œìƒ ì‹œí‚¨ë‹¤. 

Observable í´ë˜ìŠ¤ëŠ” ì´ë²¤íŠ¸ë¥¼ êµ¬ë…í•˜ëŠ” ì±„íŒ…ì•±ì„ ì‚¬ìš©í•˜ëŠ” ì‚¬ìš©ìì´ë©° subscibe í•¨ìˆ˜ë¥¼ í†µí•´ ì´ë²¤íŠ¸ì— ëŒ€í•œ í–‰ìœ„ë¥¼ ì •ì˜í•œë‹¤. 


### ì°¸ì¡°
[ì•µê·¤ëŸ¬ íŠœí† ë¦¬ì–¼(Angular tutorial) - 15 : Observable](https://lts0606.tistory.com/365?category=775312)